---
title: Bayes Theorem
layout: default
permalink: /index.php/Bayes_Theorem
---

# Bayes Theorem

## Bayes Theorem

Пусть $H = \{H_1, H_2, ..., H_n\}$ образуют полную группу событий и $A$ может выполняться только при выполнении одного из $\{ H_i \}$.

Назовём события $H_1, H_2, ..., H_n$ ''гипотезами'', поскольку заранее не известно, какое из них наступит.

''Bayes Theorem'' позволяет переоценить вероятность гипотез после того, как становится известным результат испытания, после которого появилось $A$.

$P(H_i |  A) = \frac{P(H_i) P(A | H_i)}{P(H_1) P(A|H_1) + P(H_2) P(A|H_2) + ... + P(H_n) P(A|H_n)}$ |

$P(H_i)$ называется ''априорной вероятностью'', $P(H_i| A)$ - ''апостериорной''. |
### Вывод формулы
- Допустим, что произведено испытание, в результате которого появилось событие $A$. 
- Найдем условные вероятности $P(H_1| A), P(H_2|A), ..., P(H_n|A)$  |: Т.е. вероятности гипотез, при условии, что событие $A$ уже наступило. 

- Для $P(H_1| A) $по теореме умножения имеем  |: $P(A H_1) = P(A) P(H_1 A) = P(H_1) P(A |  H_1)$ |: Т.е. $P(H_1 |  A) = \frac{P(H_1) P(A | H_1)}{P(A)}$ |- Если заменить все $P(A)$ на формулу полной вероятности, то получим 
: $P(H_1 |  A) = \frac{P(H_1) P(A | H_1)}{P(H_1) P(A|H_1) + P(H_2) P(A|H_2) + ... + P(H_n) P(A|H_n)}$ |- Аналогично и для других гипотез. Т.е. 
: $P(H_i |  A) = \frac{P(H_i) P(A | H_i)}{P(H_1) P(A|H_1) + P(H_2) P(A|H_2) + ... + P(H_n) P(A|H_n)}$ |

### Пример 1
Каждый из трех стрелков может сделать два выстрела. Probability попаданий: $P(A_1) = 0.3$, $P(A_2) = 0.5$ и $P(A_3) = 0.8$. Один из стрелков выстрелил два раза и ни разу не попал. Какая вероятность, что стрелком был первый?

- Пусть гипотеза $H_1$ - стрелял первый, $H_2$ - стрелял второй и $H_3$ - стрелял третий. 
- $P(H_1) = P(H_2) = P(H_3) = \frac{1}{3}$. 
- $D$ - стрелок промахивается два раза.
- $P(D| H_1) = 0.7 * 0.7 = 0.49$ |- $P(D| H_2) = 0.25$ |- $P(D| H_3) = 0.04$ |
Тогда по формуле Байеса
- $P(H_1| D) = 0.628$ |
### Пример 2
В первом ящике лежит 2 золотых монеты, во втором одна золотая, одна серебряная, а в третьем - две серебряных. Случайным образом выбирается монета, которая оказывается золотой. Какая вероятность того, что вторая монета в том же ящике тоже золотая?

Золотой вторая монета может быть только в первом ящике, поэтому нужно найти вероятность того, что монета извлечена из первого ящика.

Пусть $H_1$ - монета извлечена из первого ящика, $H_2$ - из второго и $H_3$ - из третьего. Очевидно, что $P(H_1) = P(H_2) = P(H_3) = \fraq{1}{3}$.

$D$ - вытащенная монета является золотой. Тогда $P(D| H_1) = 1$, $P(D|H_2) = 0.5$ и $P(D|H_3) = 0$.  |
Вычислим $P(H_1| D)$ по формуле $P(H_1|D) = \frac{ P(H_1) P(A|H_1) }{ \sum_{i=1}^{3} P(H_i) P(D|H_i) }$ |

## See also
- [Conditional Probability](Conditional_Probability)
- [Law of Total Probability](Law_of_Total_Probability)

## Источники и ссылки
- Гмурман В.Е., Теория вероятностей и математическая статистика -- 9-е издание. М.: Высш. шк., 2003.
- [Конспект по теории вероятности и математической статистике](http://www.dropbox.com/s/j9yxtvkd0ns5eot/Probability_and_Statistics_exams_c.pdf#13)

[Category:Russian](Category_Russian)
[Category:Probability](Category_Probability)
[Category:Подготовка к ШАД](Category_Подготовка_к_ШАД)